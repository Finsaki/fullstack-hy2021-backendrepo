{"version":3,"sources":["services/persons.js","App.js","index.js"],"names":["baseUrl","returnDefaultObject","getAllPersons","axios","get","then","response","data","createPerson","newObject","post","updatePerson","id","put","deletePerson","delete","Persons","props","filteredPhonebook","persons","filter","person","name","toLocaleLowerCase","includes","newFilter","map","handlePersonDelete","Person","number","onClick","Filter","value","onChange","handleFilterChange","PersonForm","onSubmit","addPerson","newName","handleNameChange","newNumber","handleNumberChange","type","Notification","message","className","Error","App","useState","setPersons","setNewName","setNewNumber","setNewFilter","notificationMessage","setNotificationMessage","errorMessage","setErrorMessage","useEffect","personService","initialPersons","replacePerson","changedPersonObject","returnedPerson","result","showNoticeMessage","catch","error","showErrorMessage","setTimeout","event","target","preventDefault","some","window","confirm","oldPerson","find","console","log","personObject","concat","personToBeDeleted","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.f4b4d02f.chunk.js","sourcesContent":["import axios from 'axios'\r\nconst baseUrl = '/api/persons'\r\n\r\nconst getAllPersons = () => {\r\n  const request = axios.get(baseUrl)\r\n  return request.then(response => response.data)\r\n}\r\n\r\nconst createPerson = newObject => {\r\n  const request = axios.post(baseUrl, newObject)\r\n  return request.then(response => response.data)\r\n}\r\n\r\nconst updatePerson = (id, newObject) => {\r\n  const request = axios.put(`${baseUrl}/${id}`, newObject)\r\n  return request.then(response => response.data)\r\n}\r\n\r\nconst deletePerson = (id) => {\r\n  const request = axios.delete(`${baseUrl}/${id}`)\r\n  //unused return, mayby useful later\r\n  return request.then(response => response.data)\r\n}\r\n\r\nconst returnDefaultObject = { getAllPersons, createPerson, updatePerson, deletePerson }\r\nexport default returnDefaultObject","import React, { useState, useEffect } from 'react'\r\nimport personService from './services/persons'\r\n\r\n/*\r\n* Aki K. 23.09.2021, updated 31.10.2021\r\n*/\r\n\r\nconst App = () => {\r\n  const [persons, setPersons] = useState([]) \r\n  const [newName, setNewName] = useState('')\r\n  const [newNumber, setNewNumber] = useState('')\r\n  const [newFilter, setNewFilter] = useState('')\r\n  const [notificationMessage, setNotificationMessage] = useState(null)\r\n  const [errorMessage, setErrorMessage] = useState(null)\r\n\r\n  //fetching persons data with axios from persons.js module\r\n  useEffect(() => {\r\n    personService\r\n      .getAllPersons()\r\n      .then(initialPersons => {\r\n        setPersons(initialPersons)\r\n      })\r\n  }, [])\r\n\r\n  const addPerson = (event) => {\r\n    event.preventDefault()\r\n    //checking if person to be added already exists\r\n    //could also check if the given newName is empty, but mayby it can be allowed\r\n    const checkDoublePerson = persons.some(person => person.name === newName)\r\n    if (checkDoublePerson) {\r\n      if (window.confirm(`${newName} is already added to phonebook, replace the old number with a new one?`)) {\r\n        const oldPerson = persons.find(person => person.name === newName)\r\n        replacePerson(oldPerson)\r\n      } else {\r\n        console.log('Phonebook person edit was cancelled')\r\n      }\r\n    } else {\r\n      //creating a new person\r\n      const personObject = {name: newName, number: newNumber}\r\n      personService\r\n      .createPerson(personObject)\r\n      .then(returnedPerson => {\r\n        setPersons(persons.concat(returnedPerson))\r\n        setNewName('')\r\n        setNewNumber('')\r\n      })\r\n      .then((result) => showNoticeMessage(`'${personObject.name}' was added`))\r\n      //Lets put a catch here as well if adding does not work\r\n      //Though two different browsers can still add the same name if browser is not refreshed, should that be fixed?\r\n      .catch(error => {\r\n        showErrorMessage(`Adding '${personObject.name}' failed. Reason: ${error.response.data.error}`)\r\n      })\r\n    }\r\n  }\r\n\r\n  const handleNameChange = (event) => {\r\n    setNewName(event.target.value)\r\n  }\r\n\r\n  const handleNumberChange = (event) => {\r\n    setNewNumber(event.target.value)\r\n  }\r\n\r\n  const handleFilterChange = (event) => {\r\n    setNewFilter(event.target.value)\r\n  }\r\n\r\n  const replacePerson = (person) => {\r\n    //keep the original but replace the number\r\n    const changedPersonObject = {...person, number: newNumber }\r\n    personService\r\n      .updatePerson(person.id, changedPersonObject)\r\n      .then(returnedPerson => {\r\n        setPersons(persons.map(person => person.id !== changedPersonObject.id ? person : returnedPerson))\r\n        setNewName('')\r\n        setNewNumber('')\r\n      })\r\n      //This needs a arrow function to work...otherwise both the success and failure are printed incase of error. I wonder why?\r\n      .then((result) => showNoticeMessage(`'${changedPersonObject.name}' was edited`))\r\n      .catch(error => {\r\n        //I wonder if the info that was already removed in the server should now also be removed from their local view, or could just ask user to refresh browser?\r\n        //This can be an error that the person was already removed, or user tried to replace existing person with too short name or number\r\n        showErrorMessage(`Editing '${changedPersonObject.name}' failed. Reason: ${error.response.data.error}`)\r\n      })\r\n  }\r\n\r\n  const showNoticeMessage = (message) => {\r\n    //clearing out message if previous one is still visible\r\n    setNotificationMessage(null)\r\n    //setting a new timed notification message\r\n    setNotificationMessage(message)\r\n    setTimeout(() => {\r\n      setNotificationMessage(null)\r\n    }, 4000)\r\n  }\r\n\r\n  const showErrorMessage = (message) => {\r\n    //clearing out message if previous one is still visible\r\n    setErrorMessage(null)\r\n    //setting a new timed error message\r\n    setErrorMessage(message)\r\n    setTimeout(() => {\r\n      setErrorMessage(null)\r\n    }, 4000)\r\n  }\r\n\r\n  const handlePersonDelete = (id) => {\r\n    const personToBeDeleted = persons.find(person => person.id === id)\r\n    if (window.confirm(`Delete person ${personToBeDeleted.name}?`)) {\r\n      personService\r\n        .deletePerson(id)\r\n        //These then functions needs a arrow function to work...otherwise both the success and failure are printed incase of error. I wonder why?\r\n        .then((result) => setPersons(persons.filter(person => person.id !== id)))\r\n        .then((result) => showNoticeMessage(`'${personToBeDeleted.name}' was deleted`))\r\n        .catch(error => {\r\n          //I wonder if the info that was already removed in the server should now also be removed from their local view, or could just ask user to refresh browser?\r\n          showErrorMessage(`Deleting '${personToBeDeleted.name}' failed. Reason: already removed from the server`)\r\n        })\r\n    } else {\r\n      console.log('Phonebook person delete was cancelled')\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h2>Phonebook</h2>\r\n      <Notification message={notificationMessage} />\r\n      <Error message={errorMessage} />\r\n      <Filter newFilter={newFilter} handleFilterChange={handleFilterChange}/>\r\n      <h2>add a new</h2>\r\n      <PersonForm newName={newName} newNumber={newNumber} addPerson={addPerson} handleNameChange={handleNameChange} handleNumberChange={handleNumberChange}/>\r\n      <h2>Numbers</h2>\r\n      <Persons persons={persons} newFilter={newFilter} handlePersonDelete={handlePersonDelete} />\r\n    </div>\r\n  )\r\n}\r\n\r\nconst Persons = (props) => {\r\n  const filteredPhonebook = props.persons.filter(person => person.name.toLocaleLowerCase().includes(props.newFilter.toLocaleLowerCase()))\r\n  //if I dont use arrow function for handlePersonDelete in here then the app will get stuck. But why is that? Mayby because im setting it up with a parameter here...\r\n  return (\r\n    <div>\r\n        {filteredPhonebook.map(person => <Person key={person.id} person={person} handlePersonDelete={() => props.handlePersonDelete(person.id)}/>)}\r\n    </div>\r\n  )\r\n}\r\n\r\nconst Person = ({person, handlePersonDelete}) => {\r\n  return (\r\n    <div>\r\n      {person.name} {person.number} <button onClick={handlePersonDelete}>delete</button>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst Filter = (props) => {\r\n  return (\r\n    <div>\r\n      filter shown with <input value={props.newFilter} onChange={props.handleFilterChange}/>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst PersonForm = (props) => {\r\n  return (\r\n    <div>\r\n      <form onSubmit={props.addPerson}>\r\n        <div>name: <input value={props.newName} onChange={props.handleNameChange}/> </div>\r\n        <div>number: <input value={props.newNumber} onChange={props.handleNumberChange}/> </div>\r\n        <div><button type=\"submit\">add</button></div>\r\n      </form>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst Notification = ({message}) => {\r\n  if (message === null) {\r\n    return null\r\n  }\r\n\r\n  return (\r\n    <div className=\"notification\">\r\n      {message}\r\n    </div>\r\n  )\r\n}\r\n\r\nconst Error = ({message}) => {\r\n  if (message === null) {\r\n    return null\r\n  }\r\n\r\n  return (\r\n    <div className=\"error\">\r\n      {message}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default App\r\n","import ReactDOM from 'react-dom';\nimport App from './App';\nimport './index.css'\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}